# ============================================
# CLOUDFLARE WORKER CONFIGURATION
# Wild Fitness Email Service
# ============================================

name = "wild-fitness-email-worker"
main = "worker.js"
compatibility_date = "2024-01-20"

# Rutas del Worker
routes = [
  { pattern = "wild-fitness.com/api/*", zone_name = "wild-fitness.com" }
]

# Variables de entorno (configurar en Cloudflare Dashboard)
# No incluir valores sensibles aquí
[vars]
ENVIRONMENT = "production"

# ============================================
# KV NAMESPACE - Almacenamiento de Actividades
# ============================================

# Bind para sincronizar actividades entre frontend y cron worker
# Crear con: wrangler kv:namespace create ACTIVITIES_KV
[[kv_namespaces]]
binding = "ACTIVITIES_KV"
id = "TU_KV_NAMESPACE_ID"  # Reemplazar con tu ID del KV namespace

# Variables secretas (configurar con: npx wrangler secret put RESEND_API_KEY)
# RESEND_API_KEY = "tu_api_key_aquí" # NO incluir aquí, usar el comando secret

# ==================================================
# INSTRUCCIONES DE DEPLOY:
# ==================================================
#
# 1. Instalar Wrangler (CLI de Cloudflare):
#    npm install -g wrangler
#
# 2. Login en Cloudflare:
#    npx wrangler login
#
# 3. Crear KV Namespace (para sincronizar actividades):
#    wrangler kv namespace create ACTIVITIES_KV
#    Copiar el ID que te devuelve y pegarlo arriba en la línea 28
#
# 4. Configurar API Key de Resend:
#    npx wrangler secret put RESEND_API_KEY
#    (Pegar tu API key de https://resend.com/api-keys)
#
# 5. Deploy del Worker:
#    npx wrangler deploy
#
# 6. El Worker estará disponible en:
#    https://wild-fitness.com/api/send-welcome-email
#    https://wild-fitness.com/api/send-booking-confirmation
#    https://wild-fitness.com/api/sync-activities
#
# ==================================================
# OBTENER API KEY DE RESEND:
# ==================================================
#
# 1. Crear cuenta en: https://resend.com/signup
# 2. Verificar dominio wild-fitness.com
# 3. Añadir estos DNS records en Cloudflare:
#    - TXT record para verificación
#    - MX records para recepción
#    - DKIM records para autenticación
# 4. Crear API Key en: https://resend.com/api-keys
# 5. Guardar la API key de forma segura
#
# ==================================================
# TESTING LOCAL:
# ==================================================
#
# Ejecutar localmente:
#    npx wrangler dev
#
# El Worker estará en:
#    http://localhost:8787/api/send-welcome-email
#
# ==================================================
